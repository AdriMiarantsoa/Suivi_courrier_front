{"ast":null,"code":"import _regeneratorRuntime from \"/home/adrienna/Documents/Stage/Suivi_courrier_front/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";\nimport _asyncToGenerator from \"/home/adrienna/Documents/Stage/Suivi_courrier_front/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport _toConsumableArray from \"/home/adrienna/Documents/Stage/Suivi_courrier_front/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";\nimport \"core-js/modules/es.array.concat.js\";\nimport \"core-js/modules/es.array.fill.js\";\nimport \"core-js/modules/es.object.to-string.js\";\nimport \"core-js/modules/web.dom-collections.for-each.js\";\nimport { Bar } from 'vue-chartjs';\nimport { Chart as ChartJS, Title, Tooltip, Legend, BarElement, CategoryScale, LinearScale } from 'chart.js';\nimport axios from 'axios';\n\n// Register Chart.js components\nChartJS.register(Title, Tooltip, Legend, BarElement, CategoryScale, LinearScale);\nexport default {\n  components: {\n    BarChart: Bar\n  },\n  data: function data() {\n    return {\n      statisticsData: [],\n      departementName: '',\n      departementId: '',\n      selectedMonth: '',\n      selectedYear: ''\n    };\n  },\n  computed: {\n    chartDataGeneral: function chartDataGeneral() {\n      if (this.statisticsData.length === 0) {\n        return null;\n      }\n      var labels = ['January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December'];\n      var data = Array(12).fill(0); // Initialize data array with zeros\n\n      this.statisticsData.forEach(function (item) {\n        var monthIndex = item.month;\n        if (monthIndex >= 1 && monthIndex <= 12) {\n          data[monthIndex - 1] += item.courrierCount; // Accumulate counts for each month\n        }\n      });\n      return {\n        labels: labels,\n        datasets: [{\n          label: 'Statistics of Document this year',\n          backgroundColor: '#42A5F5',\n          data: data\n        }]\n      };\n    },\n    chartOptions: function chartOptions() {\n      var dataValues = this.chartDataGeneral ? this.chartDataGeneral.datasets[0].data : [];\n      var minDataValue = Math.min.apply(Math, _toConsumableArray(dataValues).concat([0]));\n      var maxDataValue = Math.max.apply(Math, _toConsumableArray(dataValues).concat([0]));\n      var range = maxDataValue - minDataValue;\n      var stepSize;\n      if (range <= 10) {\n        stepSize = 1;\n      } else if (range <= 100) {\n        stepSize = 10;\n      } else {\n        stepSize = Math.ceil(range / 10);\n      }\n      return {\n        responsive: true,\n        maintainAspectRatio: false,\n        plugins: {\n          legend: {\n            display: true\n          },\n          title: {\n            display: true,\n            text: 'Document Statistics'\n          }\n        },\n        scales: {\n          y: {\n            min: Math.max(0, minDataValue - stepSize),\n            max: Math.ceil(maxDataValue / stepSize) * stepSize,\n            ticks: {\n              stepSize: stepSize\n            }\n          }\n        }\n      };\n    }\n  },\n  mounted: function mounted() {\n    this.getDepartement();\n  },\n  methods: {\n    getDepartement: function getDepartement() {\n      var _this = this;\n      return _asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee() {\n        var userresponse, recu_par, responsedept, deptresponse;\n        return _regeneratorRuntime().wrap(function _callee$(_context) {\n          while (1) switch (_context.prev = _context.next) {\n            case 0:\n              _context.prev = 0;\n              _context.next = 3;\n              return axios.get('http://localhost:8081/api/utilisateur', {\n                headers: {\n                  Authorization: \"Bearer \".concat(localStorage.getItem('authToken'))\n                }\n              });\n            case 3:\n              userresponse = _context.sent;\n              recu_par = userresponse.data;\n              if (recu_par) {\n                _context.next = 8;\n                break;\n              }\n              console.error(\"User  data is missing\");\n              return _context.abrupt(\"return\");\n            case 8:\n              _context.next = 10;\n              return axios.get(\"http://localhost:8081/api/departement/utilisateur/\".concat(recu_par.id_utilisateur));\n            case 10:\n              responsedept = _context.sent;\n              _this.departementId = responsedept.data;\n              _context.next = 14;\n              return axios.get(\"http://localhost:8081/api/departement/\".concat(_this.departementId));\n            case 14:\n              deptresponse = _context.sent;\n              _this.departementName = deptresponse.data;\n              _context.next = 18;\n              return _this.fetchStatistics();\n            case 18:\n              _context.next = 23;\n              break;\n            case 20:\n              _context.prev = 20;\n              _context.t0 = _context[\"catch\"](0);\n              console.error(_context.t0);\n            case 23:\n            case \"end\":\n              return _context.stop();\n          }\n        }, _callee, null, [[0, 20]]);\n      }))();\n    },\n    fetchStatistics: function fetchStatistics() {\n      var _this2 = this;\n      return _asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2() {\n        var response, _response;\n        return _regeneratorRuntime().wrap(function _callee2$(_context2) {\n          while (1) switch (_context2.prev = _context2.next) {\n            case 0:\n              if (!(_this2.selectedMonth === '' && _this2.selectedYear === '')) {\n                _context2.next = 8;\n                break;\n              }\n              _context2.next = 3;\n              return axios.get(\"http://localhost:8081/api/statistique-general/courriers/\".concat(_this2.departementId));\n            case 3:\n              response = _context2.sent;\n              _this2.statisticsData = response.data;\n              console.log(\"General Statistics Data:\", _this2.statisticsData);\n              _context2.next = 13;\n              break;\n            case 8:\n              _context2.next = 10;\n              return axios.get(\"http://localhost:8081/api/statistique/courriers/\".concat(_this2.departementId, \"/\").concat(_this2.selectedYear));\n            case 10:\n              _response = _context2.sent;\n              _this2.statisticsData = _response.data;\n              console.log(\"Monthly Statistics Data:\", _this2.statisticsData);\n            case 13:\n            case \"end\":\n              return _context2.stop();\n          }\n        }, _callee2);\n      }))();\n    }\n  }\n};","map":{"version":3,"names":["Bar","Chart","ChartJS","Title","Tooltip","Legend","BarElement","CategoryScale","LinearScale","axios","register","components","BarChart","data","statisticsData","departementName","departementId","selectedMonth","selectedYear","computed","chartDataGeneral","length","labels","Array","fill","forEach","item","monthIndex","month","courrierCount","datasets","label","backgroundColor","chartOptions","dataValues","minDataValue","Math","min","apply","_toConsumableArray","concat","maxDataValue","max","range","stepSize","ceil","responsive","maintainAspectRatio","plugins","legend","display","title","text","scales","y","ticks","mounted","getDepartement","methods","_this","_asyncToGenerator","_regeneratorRuntime","mark","_callee","userresponse","recu_par","responsedept","deptresponse","wrap","_callee$","_context","prev","next","get","headers","Authorization","localStorage","getItem","sent","console","error","abrupt","id_utilisateur","fetchStatistics","t0","stop","_this2","_callee2","response","_response","_callee2$","_context2","log"],"sources":["src/pages/StatistiqueCourrierDept.vue"],"sourcesContent":["<template>\n  <div>\n    <div class=\"row\">\n      <div class=\"col-12\">\n        <div class=\"card\">\n          <div class=\"card-body\" style=\"height: 400px; display: flex; flex-direction: column;\">\n            <h3 style=\"color:#003366;\">{{ departementName }}</h3>\n            <h6>Statistics of the number of documents in the department</h6>\n            <form @submit.prevent=\"fetchStatistics\" class=\"form-inline\">\n              <div class=\"form-group mx-sm-3 mb-2\">\n                <label for=\"month\" class=\"mr-2\">Month:</label>\n                <select v-model=\"selectedMonth\" id=\"month\" class=\"form-control\">\n                  <option value=\"\">Select Month</option>\n                  <option value=\"1\">January</option>\n                  <option value=\"2\">February</option>\n                  <option value=\"3\">March</option>\n                  <option value=\"4\">April</option>\n                  <option value=\"5\">May</option>\n                  <option value=\"6\">June</option>\n                  <option value=\"7\">July</option>\n                  <option value=\"8\">August</option>\n                  <option value=\"9\">September</option>\n                  <option value=\"10\">October</option>\n                  <option value=\"11\">November</option>\n                  <option value=\"12\">December</option>\n                </select>\n              </div>\n              <div class=\"form-group mx-sm-3 mb-2\">\n                <label for=\"year\" class=\"mr-2\">Year:</label>\n                <input type=\"number\" v-model=\"selectedYear\" id=\"year\" class=\"form-control\" placeholder=\"Year\" />\n              </div>\n              <button type=\"submit\" class=\"btn btn-primary mb-2\">Fetch Statistics</button>\n            </form>\n            <div style=\"flex-grow: 1; display: flex; align-items: center; justify-content: center;\">\n              <bar-chart v-if=\"chartDataGeneral\" :data=\"chartDataGeneral\" :options=\"chartOptions\"></bar-chart>\n              <p v-else>Aucune donnée à afficher.</p>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport { Bar } from 'vue-chartjs';\nimport { Chart as ChartJS, Title, Tooltip, Legend, BarElement, CategoryScale, LinearScale } from 'chart.js';\nimport axios from 'axios';\n\n// Register Chart.js components\nChartJS.register(Title, Tooltip, Legend, BarElement, CategoryScale, LinearScale);\n\nexport default {\n  components: {\n    BarChart: Bar\n  },\n  data() {\n    return {\n      statisticsData: [],\n      departementName: '',\n      departementId: '',\n      selectedMonth: '',\n      selectedYear: '',\n    };\n  },\n  computed: {\n    chartDataGeneral() {\n      if (this.statisticsData.length === 0) {\n        return null;\n      }\n\n      const labels = ['January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December'];\n      const data = Array(12).fill(0); // Initialize data array with zeros\n\n      this.statisticsData.forEach(item => {\n        const monthIndex = item.month; \n        if (monthIndex >= 1 && monthIndex <= 12) {\n          data[monthIndex - 1] += item.courrierCount; // Accumulate counts for each month\n        }\n      });\n\n      return {\n        labels: labels,\n        datasets: [\n          {\n            label: 'Statistics of Document this year',\n            backgroundColor: '#42A5F5',\n            data: data\n          }\n        ]\n      };\n    },\n    chartOptions() {\n      const dataValues = this.chartDataGeneral ? this.chartDataGeneral.datasets[0].data : [];\n      const minDataValue = Math.min(...dataValues, 0); \n      const maxDataValue = Math.max(...dataValues, 0);\n      const range = maxDataValue - minDataValue;\n\n      let stepSize;\n      if (range <= 10) {\n        stepSize = 1; \n      } else if (range <= 100) {\n        stepSize = 10; \n      } else {\n        stepSize = Math.ceil(range / 10);\n      }\n\n      return {\n        responsive: true,\n        maintainAspectRatio: false,\n        plugins: {\n          legend: {\n            display: true\n          },\n          title: {\n            display: true,\n            text: 'Document Statistics'\n          }\n        },\n        scales: {\n          y: {\n            min: Math.max(0, minDataValue - stepSize),\n            max: Math.ceil(maxDataValue / stepSize) * stepSize,\n            ticks: {\n              stepSize: stepSize\n            }\n          }\n        }\n      };\n    }\n  },\n  mounted() {\n    this.getDepartement();\n  },\n  methods: {\n    async getDepartement() {\n      try {\n        const userresponse = await axios.get('http://localhost:8081/api/utilisateur', {\n          headers: {\n            Authorization: `Bearer ${localStorage.getItem('authToken')}`,\n          },\n        });\n        const recu_par = userresponse.data; \n        if (!recu_par) {\n          console.error(\"User  data is missing\");\n          return;\n        }\n        const responsedept = await axios.get(`http://localhost:8081/api/departement/utilisateur/${recu_par.id_utilisateur}`);\n        this.departementId = responsedept.data;\n\n        const deptresponse = await axios.get(`http://localhost:8081/api/departement/${this.departementId}`);\n        this.departementName = deptresponse.data;\n\n        await this.fetchStatistics(); // Fetch statistics after getting department info\n      } catch (error) {\n        console.error(error);\n      }\n    },\n    async fetchStatistics() {\n      if (this.selectedMonth === '' && this.selectedYear === '') {\n        // Fetch general statistics if no month and year are selected\n        const response = await axios.get(`http://localhost:8081/api/statistique-general/courriers/${this.departementId}`);\n        this.statisticsData = response.data;\n        console.log(\"General Statistics Data:\", this.statisticsData);\n      } else {\n        // Fetch monthly statistics if month and year are selected\n        const response = await axios.get(`http://localhost:8081/api/statistique/courriers/${this.departementId}/${this.selectedYear}`);\n        this.statisticsData = response.data;\n        console.log(\"Monthly Statistics Data:\", this.statisticsData);\n      }\n    }\n  }\n};\n</script>\n\n<style scoped>\n.form-inline {\n  display: flex;\n  align-items: center;\n  justify-content: flex-start;\n}\n\n.form-group {\n  margin-right: 15px;\n}\n\n.btn {\n  margin-left: 10px;\n}\n</style>"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}