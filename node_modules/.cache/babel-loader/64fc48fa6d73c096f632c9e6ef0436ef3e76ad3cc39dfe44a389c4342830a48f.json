{"ast":null,"code":"import _regeneratorRuntime from \"/home/adrienna/Documents/Stage/Suivi_courrier_front/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";\nimport _asyncToGenerator from \"/home/adrienna/Documents/Stage/Suivi_courrier_front/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport axios from 'axios';\nexport default {\n  data: function data() {\n    return {\n      courriers: [],\n      departementId: '',\n      user: null\n    };\n  },\n  mounted: function mounted() {\n    this.getCourriersAlerte();\n  },\n  methods: {\n    getCourriersAlerte: function getCourriersAlerte() {\n      var _this = this;\n      return _asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee() {\n        var userResponse, responsedept, response;\n        return _regeneratorRuntime().wrap(function _callee$(_context) {\n          while (1) switch (_context.prev = _context.next) {\n            case 0:\n              _context.prev = 0;\n              _context.next = 3;\n              return axios.get('http://localhost:8081/api/utilisateur', {\n                headers: {\n                  Authorization: \"Bearer \".concat(localStorage.getItem('authToken'))\n                }\n              });\n            case 3:\n              userResponse = _context.sent;\n              _this.user = userResponse.data;\n              if (_this.user) {\n                _context.next = 8;\n                break;\n              }\n              console.error(\"Données utilisateur manquantes\");\n              return _context.abrupt(\"return\");\n            case 8:\n              _context.next = 10;\n              return axios.get(\"http://localhost:8081/api/departement/utilisateur/\".concat(_this.user.id_utilisateur));\n            case 10:\n              responsedept = _context.sent;\n              _this.departementId = responsedept.data;\n\n              // Récupérer les courriers en alerte pour le département\n              _context.next = 14;\n              return axios.get(\"http://localhost:8081/api/departement/\".concat(_this.departementId, \"/alerte\"));\n            case 14:\n              response = _context.sent;\n              _this.courriers = response.data;\n              _context.next = 21;\n              break;\n            case 18:\n              _context.prev = 18;\n              _context.t0 = _context[\"catch\"](0);\n              console.error(\"Erreur lors de la récupération des courriers en alerte:\", _context.t0);\n            case 21:\n            case \"end\":\n              return _context.stop();\n          }\n        }, _callee, null, [[0, 18]]);\n      }))();\n    }\n  }\n};","map":{"version":3,"names":["axios","data","courriers","departementId","user","mounted","getCourriersAlerte","methods","_this","_asyncToGenerator","_regeneratorRuntime","mark","_callee","userResponse","responsedept","response","wrap","_callee$","_context","prev","next","get","headers","Authorization","concat","localStorage","getItem","sent","console","error","abrupt","id_utilisateur","t0","stop"],"sources":["src/pages/Notifications.vue"],"sourcesContent":["<template>\n  <card title=\"Notifications\" sub-title=\"Documents en attente depuis plus de 24h\">\n    <div>\n      <div class=\"row\">\n        <div class=\"col-md-12\">\n          <table class=\"table table-hover\">\n            <thead>\n              <tr>\n                <th>Date de réception</th>\n                <th>ID</th>\n                <th>Nom</th>\n                <th>Expéditeur</th>\n              </tr>\n            </thead>\n            <tbody>\n              <tr v-for=\"courrier in courriers\" :key=\"courrier.id_courrier\">\n                <router-link\n                  :to=\"`/board/departement/${departementId}/courriers/${courrier.id_courrier}`\"\n                  tag=\"tr\"\n                  style=\"cursor: pointer\"\n                >\n                  <td>{{ courrier.date_reception }}</td>\n                  <td>{{ courrier.id_courrier }}</td>\n                  <td>{{ courrier.nom_courrier }}</td>\n                  <td>{{ courrier.expediteur }}</td>\n                </router-link>\n              </tr>\n              <tr v-if=\"courriers.length === 0\">\n                <td colspan=\"4\" class=\"text-center\">Aucun document en attente de réception depuis plus de 24 heures.</td>\n              </tr>\n            </tbody>\n          </table>\n        </div>\n      </div>\n\n      <!-- Message d'alerte -->\n      <div v-if=\"courriers.length > 0\" class=\"alert alert-danger alert-with-icon mt-3\" data-notify=\"container\">\n        <span data-notify=\"icon\" class=\"ti-bell\"></span>\n        <span>Certains documents n'ont pas encore été reçus depuis plus de 24 heures.</span>\n      </div>\n    </div>\n  </card>\n</template>\n\n<script>\nimport axios from 'axios';\n\nexport default {\n  data() {\n    return {\n      courriers: [],\n      departementId: '',\n      user: null,\n    };\n  },\n  mounted() {\n    this.getCourriersAlerte();\n  },\n  methods: {\n    async getCourriersAlerte() {\n      try {\n        // Récupérer les informations de l'utilisateur\n        const userResponse = await axios.get('http://localhost:8081/api/utilisateur', {\n          headers: {\n            Authorization: `Bearer ${localStorage.getItem('authToken')}`,\n          },\n        });\n        this.user = userResponse.data;\n        if (!this.user) {\n          console.error(\"Données utilisateur manquantes\");\n          return;\n        }\n\n        // Récupérer l'ID du département\n        const responsedept = await axios.get(`http://localhost:8081/api/departement/utilisateur/${this.user.id_utilisateur}`);\n        this.departementId = responsedept.data;\n\n        // Récupérer les courriers en alerte pour le département\n        const response = await axios.get(`http://localhost:8081/api/departement/${this.departementId}/alerte`);\n        this.courriers = response.data;\n\n      } catch (error) {\n        console.error(\"Erreur lors de la récupération des courriers en alerte:\", error);\n      }\n    },\n  },\n};\n</script>\n\n<style scoped>\n.table-hover tbody tr:hover {\n  background-color: #f5f5f5;\n  cursor: pointer;\n}\n\nth, td {\n  text-align: left; /* Aligner les en-têtes et le contenu à gauche */\n  padding: 8px; /* Ajouter un peu d'espace dans les cellules */\n  vertical-align: middle; /* Centrer verticalement */\n}\n\nth {\n  font-weight: bold;\n}\n\n.alert-with-icon {\n  display: flex;\n  align-items: center;\n}\n\n.alert-with-icon .ti-bell {\n  font-size: 1.5rem;\n  margin-right: 10px;\n}\n\n.table-hover tbody tr {\n  cursor: pointer;\n}\n\n.table-hover tbody tr td {\n  padding: 12px 8px;\n}\n</style>\n"],"mappings":";;AA6CA,OAAAA,KAAA;AAEA;EACAC,IAAA,WAAAA,KAAA;IACA;MACAC,SAAA;MACAC,aAAA;MACAC,IAAA;IACA;EACA;EACAC,OAAA,WAAAA,QAAA;IACA,KAAAC,kBAAA;EACA;EACAC,OAAA;IACAD,kBAAA,WAAAA,mBAAA;MAAA,IAAAE,KAAA;MAAA,OAAAC,iBAAA,cAAAC,mBAAA,GAAAC,IAAA,UAAAC,QAAA;QAAA,IAAAC,YAAA,EAAAC,YAAA,EAAAC,QAAA;QAAA,OAAAL,mBAAA,GAAAM,IAAA,UAAAC,SAAAC,QAAA;UAAA,kBAAAA,QAAA,CAAAC,IAAA,GAAAD,QAAA,CAAAE,IAAA;YAAA;cAAAF,QAAA,CAAAC,IAAA;cAAAD,QAAA,CAAAE,IAAA;cAAA,OAGApB,KAAA,CAAAqB,GAAA;gBACAC,OAAA;kBACAC,aAAA,YAAAC,MAAA,CAAAC,YAAA,CAAAC,OAAA;gBACA;cACA;YAAA;cAJAb,YAAA,GAAAK,QAAA,CAAAS,IAAA;cAKAnB,KAAA,CAAAJ,IAAA,GAAAS,YAAA,CAAAZ,IAAA;cAAA,IACAO,KAAA,CAAAJ,IAAA;gBAAAc,QAAA,CAAAE,IAAA;gBAAA;cAAA;cACAQ,OAAA,CAAAC,KAAA;cAAA,OAAAX,QAAA,CAAAY,MAAA;YAAA;cAAAZ,QAAA,CAAAE,IAAA;cAAA,OAKApB,KAAA,CAAAqB,GAAA,sDAAAG,MAAA,CAAAhB,KAAA,CAAAJ,IAAA,CAAA2B,cAAA;YAAA;cAAAjB,YAAA,GAAAI,QAAA,CAAAS,IAAA;cACAnB,KAAA,CAAAL,aAAA,GAAAW,YAAA,CAAAb,IAAA;;cAEA;cAAAiB,QAAA,CAAAE,IAAA;cAAA,OACApB,KAAA,CAAAqB,GAAA,0CAAAG,MAAA,CAAAhB,KAAA,CAAAL,aAAA;YAAA;cAAAY,QAAA,GAAAG,QAAA,CAAAS,IAAA;cACAnB,KAAA,CAAAN,SAAA,GAAAa,QAAA,CAAAd,IAAA;cAAAiB,QAAA,CAAAE,IAAA;cAAA;YAAA;cAAAF,QAAA,CAAAC,IAAA;cAAAD,QAAA,CAAAc,EAAA,GAAAd,QAAA;cAGAU,OAAA,CAAAC,KAAA,4DAAAX,QAAA,CAAAc,EAAA;YAAA;YAAA;cAAA,OAAAd,QAAA,CAAAe,IAAA;UAAA;QAAA,GAAArB,OAAA;MAAA;IAEA;EACA;AACA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}